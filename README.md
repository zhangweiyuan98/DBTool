# DBTool 数据库管理工具

## 概述
DBTool 是一个基于 PyQt5 的数据库管理工具，主要用于：
- 执行 SQL 查询
- 导入 Excel 数据到数据库
- 批量执行 SQL 脚本
- 数据库进程管理
- 数据导出（支持 Excel 和 CSV 格式）

## 主要功能

### 1. 快捷查询
- 支持通过酒店 CODE、名称、ID 进行快速查询
- 可设置查询结果条数限制
- 快捷键：Ctrl+F9

### 2. 数据导入
- 支持从 Excel 文件导入数据到数据库
- 可指定目标数据库和表名
- 自动创建表结构

### 3. SQL 脚本执行
- 支持批量执行文件夹中的 SQL 脚本
- 可选择执行范围（门店、集团、会员）
- 支持存储过程、函数、触发器等对象的创建

### 4. 数据导出
- 支持将查询结果导出为 Excel 或 CSV 格式
- 可选择导出全部数据或选中行数据

### 5. 进程管理
- 查看数据库进程
- 终止指定进程

## 界面说明

### 主界面布局
1. 顶部菜单栏
   - 添加服务器
   - 查看进程
2. 快捷查询区域
   - 服务器选择
   - 快速查询条件输入
3. 数据导入区域
   - Excel 文件选择
   - 目标数据库设置
4. SQL 执行区域
   - SQL 脚本文件夹选择
   - 执行控制按钮
5. 主工作区
   - SQL 编辑器
   - 结果展示标签页

## 安装说明

1. 安装 Python 3.8 或以上版本
2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```
3. 运行程序：
   ```bash
   python MainWindow.py
   ```

## 使用说明

1. 添加服务器配置
   - 通过菜单栏添加服务器连接信息
2. 执行查询
   - 在 SQL 编辑器中输入 SQL 语句
   - 点击"开搞"按钮或按 F9 执行
3. 导入数据
   - 选择 Excel 文件
   - 设置目标数据库和表名
   - 点击"导入"按钮
4. 导出数据
   - 在结果标签页右键选择导出格式
   - 选择保存路径

## 注意事项

1. 确保数据库连接信息正确
2. Excel 文件格式需符合要求
3. SQL 脚本文件需为 UTF-8 编码
4. 批量执行 SQL 时注意选择正确的执行范围

## 快捷键

| 快捷键   | 功能           |
|----------|----------------|
| F9       | 执行 SQL       |
| Ctrl+F9  | 快捷查询       |
| F12      | 停止执行       |

## 版本信息

- 当前版本：1.0.0
- 最后更新：2025-01-08
